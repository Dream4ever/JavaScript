# 2020-05-16 徐老师公益分享

## 过去一年做的事：效能

过去一年全部都focus在效能这块，给我直接带来的是3.75的绩效评分，和我一起做项目的同学也达到了3.75。个人觉得没有多好，但是和其它团队横向比较的话，还是拿到了一个相对比较好的成绩。

当时团队有两个姑娘，一个设计师，一个前端，和我一起做项目。做前端的姑娘可能因为这个3.75得到晋升，我也得到了一些不错的成绩，包括物质奖励，哈哈。

阿里的年终奖相对比较公平，你做了什么，带来了什么效果，用什么数据去证明，老板都会看在眼里。工程师所带来的价值，公司通常都会通过奖金、股权什么的去激励你，但这些激励更多的是为了让员工在未来做得更好。

过去一年做的一件事，就是设计师用Sketch做的设计稿，用imgcook就能生成伪代码，然后在自动打开的网页上粘贴并保存，就能按照React开发规范生成直接可用的代码了。有了代码之后，可以再复制到CodeSandbox里面，进行必要的确认和调整，最后页面的开发工作就完成了。

而我们去年做的这款工具带来的价值，就是可以让设计师直接通过设计稿生成代码，这也是我加入这个团队做的第一件事情。这件事情在工程师的角度来说，已经非常提效了。

之所以做这件事，就是之前想到设计师会不断做各种设计稿，开发也需要不断根据设计稿写页面，那能不能把这件事自动化呢？能否在设计师完成设计稿之后，直接把设计稿转换为代码，然后开发就直接把代码放到项目中呢？这样就能够在设计师和开发之间直接架起一道桥梁。也是白天在微信群里聊的，能否在工厂和销售之间直接沟通，砍掉那些中间环节？

我整个一年都在做low-code & codeless这件事，刚才所用的imgcook只是整个codeless环节中的一个工具，再加上其它的各种各样的工具，就可以把这个环节给它打通。设计师完成设计稿的时候，开发就能直接在Sketch中看到完成的组件，这样站在imgcook这个巨人的肩膀上，让提效更进一步。

## 今年一年要做的：给业务赋能

讲讲来龙去脉：跟中后台有关。各种公司给自己或者给别人做的各种管理系统，在用户体验方面，和开发&维护成本方面，两者之间是难以达到一个平衡的。以前常常想着用新技术去做各种项目，去做各种中后台项目，但是现在想明白一件事：这真的会给自己挖一个大坑，因为这里面的维护成本会越来越高。

假如项目采用了SPA单页面，或者用了React/Vue，或者用了VueX，我个人认为，未来会带来很多问题；如果用了React，Redux，那更是给自己带来了一个巨大的坑。如果为了用户体验，做到一次加载之后，剩下的全是数据交互，那也是一个大坑，具体怎么坑？后面会讲到。

为了避免写运营类后台项目时，不给自己和别人挖坑，我有一些想法：

### 共识的约定

首先，一定要做多页面，别用单页面。

其次，一个页面对应一个文件夹，且每个文件夹里的文件结构要固定，比如index.jsx作为页面入口，api.js作为页面接口，再加上component作为页面中所需的功能丰富的组件，以及mock.js用来本地测试。

再次，每个页面都要能够单独编译。

再次，禁止状态管理模式，比如VueX、Redux，除非是需要登录的情况。

最后，不要共用业务组件。

为什么会有这些约定，后面会讲到。

### 一招独步天下

首先，服务端拿到的数据，先转换好再使用。

其次，能提前冗余绝不事后处理。

用接口从后端拿到数据之后，先立刻进行组件所需的格式转换。这样一来，在组件的层面，只需要关注用什么数据，而不是在组件里面弄得乱七八糟的，组件不像组件。

这样一来，一旦出了问题，可以很肯定地知道是服务端的数据出了问题；后面如果需要对数据进行改变也很轻松，直接在拿到服务端数据之后，按新的规范进行处理就行。

而且这样本地mock测试也会非常方便。比如我用ramda控制流程，用nanoid生成随机字符串，用Math.random()生成随机数，用Mock.js去模拟各类数据。这样按照上面说的原则去处理数据，我的工作就会非常轻松，因为一切都是按照设定好的逻辑来的。即使发生了一点变化也很简单，继续在拿到数据的地方进行调整就好。

### 说服老板

上面说的这些共识的约定，如果大家不遵循怎么办？即使都遵循了这些约定，能确保提效么？实际上只是开发方便了点，但未必提效。

从另一方面来说，微前端可能是中后台最好的解决方案，但如何说服老板要这样做？

很多前端同学做了好几年，不知道自己的发展是什么。希望今天这个案例不仅能让大家了解中后台的微前端，还能让大家了解在工作中该如何思考，如何提效，如何实现自己的价值。

我是从这几个方面来证明微前端的价值的：

首先，就是项目的编译&启动时间。我从各个业务线都挑了些项目，对比了一下期望和实际的编译&启动时间。快的近20秒，慢的有一分钟，在等待编译完成的时候，开发人员就有可能转头去做别的事，之后要再切换回当前的工作上，有可能还会花更多的时间。如果我能把项目的编译&启动时间缩小到5秒以内，就能让开发更持续地关注在工作上。对老板来说，这样的事情必须得做啊！

其次，协作冲突。即使在阿里，写代码写得互相冲突也是常有的事情。春节我在做疫情的一个项目，当时我带着前端团队在搞，服务端是另一个团队。当时前端把数据传入库的时候就会乱码，我认为这不是我们前端的问题。本来这一天下午5点开始，打算第二天8点上线，结果最后第三天10点才上线。后来才发现，原因就是后端的一个同学解决了问题，但另一个同学又覆盖回来了，结果多花了一天的时间才让项目上线。

再次，熟悉成本高。我给了团队里的员工几个命题：有一天我给了你一个需求，你从没接触过，项目的相关事情你什么都不知道，但你就要做这个东西，那么你会怎么做？

在需要去接手一个陌生项目时，我该如何消除那些不确定的、耗时的环节？这是常常困扰大家的，也是解决了之后能够显著提效的一个点。

再次，开发周期长且重复。比如每建一个新项目，我就需要建立基础框架，需要做各种各样的功能，包括用户注册登录、埋点、菜单、权限，等等等等，这些都做完之后，我才能真正去写页面。而写页面之前的这些事情，有时会占到整体开发时间接近一半甚至还多，那有没有什么办法，把这些琐碎的事情，全都系统化、提前做好，需要开发新项目的时候，不再占用开发人员的时间？

### 趋势

微前端是未来中后台的趋势，每家公司对它的概念都摆在那里，但实际应用一定会是跟公司的实际业务有深入关联的，这就是今天微前端的一个价值。当然了，大公司的确有这个必要，小公司还是先把自己的核心业务做好。

中后台页面，普遍都是上方导航栏，左侧菜单，中间是内容这种结构。那要去构建这个东西的话，其实就是构建一个页面。传统的方式就是加载一个JS，渲染到一个HTML上。但现在是不是可以换个思路？虽然渲染在一个页面上，但是不是可以通过多个HTML来展示？导航、菜单、内容，分别是不同的HTML，不同的HTML可以理解为不同的APP。

大公司的各种管理系统，域名都是相同的，那么可以通过域名后的路径/bu/app来定义业务域。bu是业务标识，决定当前基座项目所要加载的apps，app则是每个要加载的具体的APP的标识。

基座应用通过CDN加载多个APP，渲染到页面的对应位置。各个APP所需的数据，都调用自己的后端接口就好了。而运营平台则负责管理各个APP，管理页面的布局等等。

支付宝开源了一个项目：qiankun，一个页面引入了不同的引用，互相之间不会干扰，大家可以去研究一下。

但是这样一来，在一个大页面上运行各种APP，就涉及权限的事情了：我有没有权限访问这个APP？

基座应用通过域名为指定的应用加载所需的子应用时候，子应用其实就是页面，那么就需要调用数据，页面中就会有一堆API。我在创建业务的时候，会为这个业务建立对应的权限组，业务下所需的子应用，我会为这些子应用建立对应的角色。这样一来，我就能通过一个主应用去管理整个API。

那么每个子应用就是一个子页面，就需要统一一些约定。以前的后台项目粒度很大，一个业务一个后台，粒度就是project。今天的话，粒度就是一个页面，这个页面虽然也是project，但却是一个非常小的project。因此，才积累出了前面所说的共识的约定。

子应用注册到运营平台之后，后面会连同权限也一同注册进去。用户点击页面上左侧的菜单，基座应用就会去fetch config。基座应用同时也会fetch app info，这里正是为了解决前面所说的，熟悉陌生项目的成本非常大的问题。比如我打开一个后台系统的页面，我在各个子应用下面放一个button，就叫开发小助手，传数据的时候传一个debug: true的时候就会显示出来，点击这个按钮就会显示项目的各种基本信息，这样不就把熟悉陌生项目的成本全都cut掉了？

而且每个子应用都非常小，工程师在这个子应用上去做修改会非常轻松。子应用的数据像前面说的那样，接口全在api.js里面，mock全在mock.js里面，接口全在component里面，这得节省多少的工作量？是吧。

### 从什么项目入手？

运营类中后台，内部中后台，活动类H5，这些项目都是可以试着去运用上面所说的这套体系的。

## 前端发展：浅水区和深水区

### 浅水区（自嗨区）

有一天我在内网看到了一篇文章，好像就是《前端的深水区，我们该做什么？》。我这次分享的目的，是希望大家能有一些发展，你是始终在浅水区里面玩，还是去深水区勇敢试水？

很多人都在浅水区里面玩，比如语言：JS，HTML，CSS → LESS/SASS；比如框架：React，Vue，Angular；等等等等。

你把一个东西学到融会贯通之后，再学新技术其实很快就能掌握了。如果学太多东西，其实只是自嗨，不能在项目里应用的话，很快就会忘掉，并没有产生实际价值，还花了很多时间。包括PWA、SSR、SPA，如果天天在这些里面待着跳不出去，不能用它把业务做得更好，那其实没有太多价值的。还有平台，包括RN，Flutter，Weex什么的，也没必要折腾。比如我，就会选我自己最熟悉的，比如RN，我选它是为了能够快速干活，而不是耍酷。这两年很酷炫的GraphQL，目前在阿里其实用得非常少。因为很多时候，关键的问题在于能不能把接口写清楚，把事情讲清楚；至于用什么技术来写接口，其实反而都是次要的。

浅水区的东西，对产品、对业务来说是无感的，再怎么折腾浅水区的东西，都很难让业务大幅提效。

### 深水区（掉头发区）

首先，业务型技术。我们今天的前端，怎么做业务的提效？

一个就是如何快速地搭建常用的框架？技术能不能驱动业务？浅水区的那些东西，没有一个是能驱动业务的，对业务来说是无感的。而深水区的各种东西，是用来驱动业务的。就是PPT上所说的，以基础建设（浅水区）为基础，以体验+效能为切入点，规划出来一个大局，去服务业务，驱动业务。

多问问自己，所做的事情能给业务带来什么好处？

比如说我上面所讲的内容，就是能够提高开发的效能。未来要做各种中后台，就不需要交给外包公司来做，也不用担心安全问题。即使我们有些页面做得不够好，想要重构的话，效率也快很多。有了运营中心之后，开发简单地去开发每个页面就好了；至于权限要如何配置，全都让运营人员去做就好了，各司其职，省心省力。

进一步想，写这种中后台页面的工作，未来是不是甚至都可以不需要开发了？设计师设计好页面，运营做好配置，一个中后台就完成了？

其次，产品型技术。它是一个非商业产品，需要你通过前端技术+技术理念+产品sense，去做一个从1到100的产品。比如支付宝开源的ant-design，它就是这样一个产品型的技术。我们在给公司产生编码价值的时候，有没有想过我们做的那些东西，是可以拿出来开源，不断打磨，去让它产生更大的价值？

如果我们做的东西，能够减少别人的工作量，提高别人的效率，那不就是能产生更大的价值了？

领域型技术，每个点都够拼命一辈子。我身边有同事加入了W3C的组织，比如WebGPU，去探索前端领域更深层次的东西。我是很佩服这些人的，但我自己不会往这方面走，一方面是精力不够，另一方面这些也不是我所擅长的，我还是应该把精力放在我所擅长的事情上。

最后，创新型技术。大家一起边走边看吧。

那么前两点，业务型技术，产品型技术，如果你想成为公司里的佼佼者，你至少在第一点上发力，就能够给公司展示出你的不可替代性。

以上这些，是我通过展示思考的过程，去告诉大家如何做业务方面的提效。

## JOB MODEL

前端的JOB MODEL到底是什么？

岗位特征分了四点：从下往上不断升高。基础扎实 → 高质量完成；独当一面 → 辅助团队；领域专家 → 影响团队；无中生有 → 引领变革。如果自己已经非常牛了，就需要带着一群人去探索一个新的领域，去引领变革。

每一层的岗位，都有九个维度、不断向上的衡量点：专业知识，技术实现，业务理解；学习与思辨，协作与共赢，规划与落地；业务理解与实现，技术沉淀与传承，团队建设与发展。

### 好的前端工程师

首先，在效能方面，有思考和实践。我们在筛选简历的时候，这一点就是好的工程师和普通工程师的区别。如果你在这方面没实践，更没有思考，那你就不能算是一个好的前端工程师。

其次，有业务sense。我们认为阿里的前端工程师的业务sense，相对要差于后端。我之前和一个后端leader聊天，他就问我，为什么前端相对更少地参与产品讨论。大家想想：如果服务端的同学，不参与业务的深层次讨论，他很可能连数据库的表都设计不出来。但是前端就不一样了，只需要让后端把接口定义清楚，只需要让设计师把设计稿、交互写清楚，前端的工作就可以完成了。

服务端不理解业务就寸步难行，前端不理解业务，有时候工作也能照样完成。而且，前端工程师的难度不在于是否理解业务，而是一方面要解决各种兼容性问题，包括浏览器的兼容问题；另外，设计师对前端也会有各种要求，天天这边挪一个px，那边动一个px，要是再来个动效，得嘞，分分钟就会多出来几天的工作量。但是忙归忙，前端工程师还是要了解业务，否则就会失去自己的竞争力。我刚才说的所有的可以提效的点，都是需要把业务了解透的；如果不了解业务，那你是没办法做到这些提效的事的。

再次，重视用户体验。

最后，用数据证明过程。前端不容易做到这点，后端相对好说，比如说单次请求响应时间是多少，能抗住多大的并发数，等等等等。前端的话，就需要从不同的角度，去发掘数据。就像我前面所说的，减少了多少编译时间，减少了熟悉陌生项目所需的时间，这就是我所带来的价值。后面在微信群里讨论的话，我也希望大家能更多地讨论这方面的问题，这样能产生更有价值的讨论。

## 碎片感悟

### 关注很多，时间很少，怎么办？

过去一年之所以没怎么和大家交流，关键之一就是工作很忙。我去年就跟团队说，一年就做一件事，这样一个定义真的是帮助了我，也帮助了大家。把一件事做精，比泛泛地做很多事要好很多。

我觉得我的长处就是给业务提效，那我就关注我擅长的这个点，我就做这件事就好了。

所以我现在给自己的定义，就是一年只做一件事。我现在的想法，就是职业里只做大事，把每一件小事做好，最后就是一件大事。
