# 选择一个 Web 架构

老师的教程，大家一定要动手做。只有亲自动手去做了，才会遇到各种问题，

## 为什么要用 nvm？

开发经验：看任何一个 Node.js 项目，首先要读这个项目的 README.md。其次，要掌握项目的核心，就要看 `package.json` 这个文件，关键的是要看 Node.js 的版本。不同项目用的 Node.js 的版本是不一样的。而 nvm 就可以很方便地安装/切换多个版本的 Node.js。

部分同学电脑环境的原因，会无法安装 nvm。这样的话，装一个比较新版的 Node.js 就行，比如 8.0.0（或者最新版）。

## 什么是 WebApp？

是想把 WebApp 设计成只提供数据的一个服务？还是一个提供页面的客户端？比如 vue-hackernews-2.0，这么一个前端的项目，会依赖 Express 这个后端项目？

因为所有的页面都是从服务器获取的，浏览器可以从一个服务器获取页面，然后从另一个服务器获取页面。这样一来前后端就解耦了。

如果立志成为一个前端工程师，学习了 Express 之后，能力范围就会比只学了前端的人广很多。

暂时不懂也没关系，一直学习、一直前进就可以了。

版本号里的 `^` 符号表示大于等于。

## Express

教程中为什么要全局安装？

框架性的项目，要看它解决的是什么问题。如果是为了在某种语言、环境下开发更方便的话，一般都会在终端下提供一组命令，以便快速建立项目。

全局安装 Express 的话，可以方便地在各个地方构建一个默认的工程项目，为开发者搭建好了基础的脚手架，这样就不用从零开始了，会方便很多。

所有的框架性的项目，都可以实现这样的需求，所以教程中让我们全局安装。

`DEBUG=first-app:* npm start`，在 `npm start` 前面的命令，是为了在项目启动时，向 `process.env` 传入参数。

`DEBUG=first-app:* PORT=3001 ABC=123 npm start`

### 为什么默认有好几个文件夹？

一个 WebApp 的工程目录应该长什么样子？好的项目，是根据丰富的经验来规定工程中的目录结构的。

一个工程最重要的是什么？入口文件。比如买了一台电脑，最开始的时候，要先找到电脑开关。

对于 Node.js 项目来说，最重要的是什么？是 `package.json`。

这个文件中，`scripts` 字段里就会写项目从哪里开始运行。

依赖包又决定了什么？决定了一个项目会有什么功能。

这就是学习一个 Node.js 项目的高频小套路！

## 目录解读

bin 之中放的是可执行文件。

public 之中放的是前端执行的资源文件。

routes 相当于“动静脉”，

views 不是必需的，不过如果开发的 WebApp 还有前端页面的话，自然也是不可少的。

app.js 相当于程序的大脑。

## www 解读

为什么官网的示例和项目中的关键代码不一样？

“废代码”的功能，是为了实现健壮性。代码也需要处理各种各样的事情，不可能只去做最核心的功能。所以为了实现健壮性，必须要有冗余。

其实可以去掉 `./bin/www`，直接从 `app.js`（或者重命名为 `server.js`、`index.js`），这样更形象，也更直接。

## 路由解读

Express 一个非常棒的地方，就在于路由看起来非常简单。

在 `app.js` 内实现了很多**注册机制**的代码。

所有的路由都会先根据25、26行的进行匹配，匹配不上的，就交给后续的代码进行处理。

`next()` 的工作机制是什么？理解了它的原理，就可以实现自己的设计了。

前面两个路由设置完成之后，剩下的就都交给最后的两个函数，只要不符合前面两个路由的设置，就都由之后的代码来解决。

**注意**：学 Express，学的是它的思路、它的运转机制。了解了它的机制之后，就可以自己去写自己的处理函数了。

## 课后作业

`npm start` 和 `npm run auto-start`，为什么前面的命令不用 `run` 就能正常执行，而后面的必须有？
